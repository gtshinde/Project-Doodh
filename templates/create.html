{% extends "base.html" %}
{% block head %}
<style>
  #fromDate,#toDate {
    text-align: center;
    font-size: 20px;
    border: white;
    height: 5%;
    width: 20%;
    position: absolute;
    margin-left: -1%;
    border-radius: 6px;
}
</style>
{% endblock %}
{% block content %}
{% if submitted=="Yes" %}
<div  id="myModal" class="modal">
  <div class="modal-content" style="height: 18%; width:50%;">
  <span class="close">&times;</span> 
  <strong>Thank you, below inputs have been registered!</strong>
  <br>
  <br>
  <script>
    // var cm = '{{ cm }}'
    var cm = "{{ form_data['cm'] }}"
    var bm = "{{ form_data['bm'] }}"
    // var bm= '{{ bm }}'
    var form_data='{{ form_data }}'

    from_date= "{{ form_data['fromDate'] }}"
    to_date= "{{ form_data['toDate'] }}"
    document.write("From Date:"+from_date+"&nbsp;&nbsp;&nbsp;")
    document.write("To Date:"+to_date+"<br>")
    document.write("Cow Milk:"+cm+"L &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;") 
    document.write("Buffalow Milk:"+bm+"L &nbsp;&nbsp;&nbsp;<br>")
  // if ('{{ display_date }}'=="True")
  // {
    // past_date='{{ past_date }}'

  // }
  </script>
  </div>
</div>
{% endif %}
{{ display_date }}
{% if display_date=='True' %}
  <div id="box" class="box">
    <strong>Change Milk Quantity for Past Date</strong>
  </div>
{% else %}
  <div id="box" class="box">
    <strong>Change Milk Quantity for Tomorrow!</strong>
  </div>
{% endif%}
<p id="try"></p> 
<form action="/create/{{user_id}}-{{display_date}}" method="POST">

  <table class="Tbl">
  <!-- <tr>
    {% if display_date=='True' %}
    <div  id="past_date_row" style="display: block;">
         <label class="DateAlign"><strong>Date</strong></label>
        <input id="past_date_input" name="past_date_input" type="date" onclick="minmaxdate()">
     </div>
    {% endif %}
  </tr> -->
  <tr>
    <label style=" position: absolute; color:white; font-size: 29px;
    margin-left: -19%;"><strong>From Date:</strong></label>
    <input type="date" name="fromDate" id="fromDate" required="required"> <br><br>
    <label style=" position: absolute; color:white; font-size: 29px;
    margin-left: -19%;"><strong>To Date:</strong></label>
    <input type="date" name="toDate" id="toDate" required="required">
  </tr>
    <tr>
      <th class="alignh" style=" height: 5%;">Cow Milk</th>
      <th>
       <select id="cm" name="cm">
        <option value="0">0</option>
        <option value="0.5">1/2</option>
        <option value="1">1</option>
        <option value="1.5">1.5</option>
        <option value="2">2</option>
        <option value="2.5">2.5</option>
        <option value="3">3</option>
        <option value="0.0">No Change</option>
       </select>
      </th>
      </tr>
      <br>
      <tr>
      <th class="alignh" style=" height: 5%;">Buffalow Milk</th>
      <th>
       <select id="bm" name="bm">
        <option value="0">0</option>
        <option value="0.5">1/2</option>
        <option value="1">1</option>
        <option value="1.5">1.5</option>
        <option value="2">2</option>
        <option value="2.5">2.5</option>
        <option value="3">3</option>
        <option value="0.0">No Change</option>
       </select>
      </th>
      </tr>
  </table>
 
  <br><br>
  
  <input type="submit" value="Submit">
</form>
<script>
  // Get the modal
  var modal = document.getElementById("myModal");
  
  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];
  
  // When the user clicks on <span> (x), close the modal
  span.onclick = function() {
    modal.style.display = "none";
  }
  
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
 function setdefaultdates() {
    
      let d = new Date()
      // d will have value like - "Wed Apr 20 2022 12:58:53 GMT+0530 (India Standard Time)"
      let today = d.toISOString().substr(0, 10);
      document.getElementById("fromDate").value = today;
      document.getElementById("toDate").value = today;
  }

document.getElementById("past_date_input").addEventListener("change",minmaxdate)
function minmaxdate() {
    let d = new Date()
    // d will have value like - "Wed Apr 20 2022 12:58:53 GMT+0530 (India Standard Time)"
    let today = d.toISOString().substr(0, 10);
    // toISOString() will return the date as "2022-04-20T07:35:36.917Z". Since we need only till index 10, we are taking the substring
    // today will have string 'YYYY-MM-DD' of the current day
    var input = document.getElementById("past_date_input");
  
    let d2 = new Date()
    d2.setFullYear(d.getFullYear(), d.getMonth()-5, 1)
    // setFullYear ('2022', 6months back, 1st day of the month)
    // when we do -5, it takes the date as 6 months back, and also goes to the previous year
    past_date = d2.toISOString().substr(0, 10);

    input.setAttribute("min", past_date);
    input.setAttribute("max", today);
}
  </script>
{% endblock %}